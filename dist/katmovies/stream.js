"use strict";var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp=Object.prototype.hasOwnProperty,__name=(e,t)=>__defProp(e,"name",{value:t,configurable:!0}),__export=(e,t)=>{for(var r in t)__defProp(e,r,{get:t[r],enumerable:!0})},__copyProps=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of __getOwnPropNames(t))__hasOwnProp.call(e,l)||l===r||__defProp(e,l,{get:()=>t[l],enumerable:!(n=__getOwnPropDesc(t,l))||n.enumerable});return e},__toCommonJS=e=>__copyProps(__defProp({},"__esModule",{value:!0}),e),__async=(e,t,r)=>new Promise((n,l)=>{var o=e=>{try{s(r.next(e))}catch(e){l(e)}},a=e=>{try{s(r.throw(e))}catch(e){l(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())}),stream_exports={};__export(stream_exports,{getStream:()=>getStream});var hubcloudDecode=__name(function(e){return void 0===e?"":atob(e.toString())},"hubcloudDecode");function hubcloudExtractor(e,t,r,n,l){return __async(this,null,function*(){var o,a,s,i,d,c;try{l.Cookie="ext_name=ojplmecpdpgccookcobabopnaifgidhf; xla=s4t; cf_clearance=woQrFGXtLfmEMBEiGUsVHrUBMT8s3cmguIzmMjmvpkg-1770053679-1.2.1.1-xBrQdciOJsweUF6F2T_OtH6jmyanN_TduQ0yslc_XqjU6RcHSxI7.YOKv6ry7oYo64868HYoULnVyww536H2eVI3R2e4wKzsky6abjPdfQPxqpUaXjxfJ02o6jl3_Vkwr4uiaU7Wy596Vdst3y78HXvVmKdIohhtPvp.vZ9_L7wvWdce0GRixjh_6JiqWmWMws46hwEt3hboaS1e1e4EoWCvj5b0M_jVwvSxBOAW5emFzvT3QrnRh4nyYmKDERnY";const u=e.split("/").slice(0,3).join("/"),h=[],p=(yield r(`${e}`,{headers:l,signal:t})).data,v=n.load(p),f=p.match(/var\s+url\s*=\s*'([^']+)';/)||[];let m=hubcloudDecode(null==(a=null==(o=f[1])?void 0:o.split("r="))?void 0:a[1])||f[1]||v(".fa-file-download.fa-lg").parent().attr("href")||e;(null==m?void 0:m.startsWith("/"))&&(m=`${u}${m}`);const y=yield fetch(m,{headers:l,signal:t,redirect:"follow"}),_=n.load(yield y.text()),k=_(".btn-success.btn-lg.h6,.btn-danger,.btn-secondary");for(const e of k){let r=_(e).attr("href")||"";switch(!0){case null==r?void 0:r.includes("pixeld"):if(!(null==r?void 0:r.includes("api"))){const e=r.split("/").pop(),t=r.split("/").slice(0,-2).join("/");r=`${t}/api/file/${e}?download`}h.push({server:"Pixeldrain",link:r,type:"mkv"});break;case(null==r?void 0:r.includes(".dev"))&&!(null==r?void 0:r.includes("/?id=")):h.push({server:"Cf Worker",link:r,type:"mkv"});break;case(null==r?void 0:r.includes("hubcloud"))||(null==r?void 0:r.includes("/?id=")):try{const e=yield fetch(r,{method:"HEAD",headers:l,signal:t,redirect:"manual"});let n=r;if(n=e.status>=300&&e.status<400?e.headers.get("location")||r:e.url&&e.url!==r?e.url:e.headers.get("location")||r,n.includes("googleusercontent"))n=n.split("?link=")[1];else{const e=yield fetch(n,{method:"HEAD",headers:l,signal:t,redirect:"manual"});n=e.status>=300&&e.status<400?(null==(s=e.headers.get("location"))?void 0:s.split("?link=")[1])||n:e.url&&e.url!==n?e.url.split("?link=")[1]||e.url:(null==(i=e.headers.get("location"))?void 0:i.split("?link=")[1])||n}h.push({server:"hubcloud",link:n,type:"mkv"})}catch(e){}break;case null==r?void 0:r.includes("cloudflarestorage"):h.push({server:"CfStorage",link:r,type:"mkv"});break;case(null==r?void 0:r.includes("fastdl"))||(null==r?void 0:r.includes("fsl.")):h.push({server:"FastDl",link:r,type:"mkv"});break;case r.includes("hubcdn")&&!r.includes("/?id="):h.push({server:"HubCdn",link:r,type:"mkv"});break;default:if((null==r?void 0:r.includes(".mkv"))||(null==r?void 0:r.includes("?token="))){const e=(null==(c=null==(d=r.match(/^(?:https?:\/\/)?(?:www\.)?([^\/]+)/i))?void 0:d[1])?void 0:c.replace(/\./g," "))||"Unknown";h.push({server:e,link:r,type:"mkv"})}}}return h}catch(e){return[]}})}function gdflixExtractor(e,t,r,n,l){return __async(this,null,function*(){var o,a,s,i,d,c,u;try{const h=[],p=(yield r(`${e}`,{headers:l,signal:t})).data;let v=n.load(p);if(null==(o=v("body").attr("onload"))?void 0:o.includes("location.replace")){const e=null==(i=null==(s=null==(a=v("body").attr("onload"))?void 0:a.split("location.replace('"))?void 0:s[1].split("'"))?void 0:i[0];if(e){const o=yield r.get(e,{headers:l,signal:t});v=n.load(o.data)}}try{const t=e.split("/").slice(0,3).join("/"),o=v(".btn-secondary").attr("href")||"";if(o.includes("indexbot")){const e=yield r.get(o,{headers:l}),t=e.data.match(/formData\.append\('token', '([a-f0-9]+)'\)/)[1],n=new FormData;n.append("token",t);const a=e.data.match(/fetch\('\/download\?id=([a-zA-Z0-9\/+]+)'/)[1],s=o.split("/download")[0],i=yield fetch(s+"/download?id="+a,{method:"POST",body:n,headers:{Referer:o,Cookie:"PHPSESSID=7e9658ce7c805dab5bbcea9046f7f308"}}),d=yield i.json();h.push({server:"ResumeBot",link:d.url,type:"mkv"})}else{const e=t+o,a=(yield r.get(e,{headers:l})).data,s=n.load(a)(".btn-success").attr("href");s&&h.push({server:"ResumeCloud",link:s,type:"mkv"})}}catch(e){}try{const e=v(".btn-danger").attr("href")||"";if(e.includes("?url=")){const t=e.split("=")[1],r=new FormData;r.append("keys",t);const n=e.split("/").slice(0,3).join("/")+"/api",l=yield fetch(n,{method:"POST",body:r,headers:{"x-token":n}}),o=yield l.json();if(!1===o.error){const e=o.url;h.push({server:"Gdrive-Instant",link:e,type:"mkv"})}}else{const n=(null==(u=null==(c=null==(d=(yield r.head(e,{headers:l,signal:t})).request)?void 0:d.responseURL)?void 0:c.split("?url="))?void 0:u[1])||e;h.push({server:"G-Drive",link:n,type:"mkv"})}}catch(e){}return h}catch(e){return[]}})}function extractKmhdLink(e,t){return __async(this,null,function*(){const{axios:r}=t,n=(yield r.get(e,{headers:{Cookie:"unlocked=true"}})).data,l=n.match(/hubdrive_res:\s*"([^"]+)"/)[1];return n.match(/hubdrive_res\s*:\s*{[^}]*?link\s*:\s*"([^"]+)"/)[1]+l})}__name(hubcloudExtractor,"hubcloudExtractor"),__name(gdflixExtractor,"gdflixExtractor"),__name(extractKmhdLink,"extractKmhdLink");var getStream=__name(function(e){return __async(this,arguments,function*({link:e,signal:t,providerContext:r}){const{axios:n,cheerio:l,commonHeaders:o}=r,a=[];try{if(e.includes("gdflix"))return yield gdflixExtractor(e,t,n,l,o);if(e.includes("kmhd")){const a=yield extractKmhdLink(e,r);return yield hubcloudExtractor(a,t,n,l,o)}if(e.includes("gdflix")){try{const t=e.replace("/file","/zfile"),r=(yield n.get(t)).data,o=l.load(r)(".btn-success").attr("href");o&&a.push({server:"ResumeCloud",link:o,type:"mkv"})}catch(e){}try{const t=yield n.get(e,{timeout:1e4}),r=l.load(t.data)(".btn-danger").attr("href")||"",o=r.split("=")[1],s=new FormData;s.append("keys",o);const i=r.split("/").slice(0,3).join("/")+"/api",d=yield fetch(i,{method:"POST",body:s,headers:{"x-token":i}}),c=yield d.json();if(!1===c.error){const e=c.url;a.push({server:"Gdrive-Instant",link:e,type:"mkv"})}}catch(e){}return a}return yield hubcloudExtractor(e,t,n,l,o)}catch(e){return[]}})},"getStream");exports.getStream=getStream;